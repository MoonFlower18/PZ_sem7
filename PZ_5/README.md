# Практическое задание №5
Журавлева Юлия БИСО-01-20

# Исследование информации о состоянии беспроводных сетей

## Цель работы

1.  Получить знания о методах исследования радиоэлектронной обстановки.
2.  Составить представление о механизмах работы Wi-Fi сетей на канальном
    и сетевом уровне модели OSI.
3.  Закрепить практические навыки использования языка программирования
    для обработки данных
4.  Закрепить знания основных функций обработки данных экосистемы
    `tidyverse` языка R

## Исходные данные

1.  ОС Windows 10
2.  RStudio Desktop
3.  Интерпретатор языка R 4.2.2
4.  Файл `mir.csv-01.csv`

## План

1.  Импортировать данные из файла `mir.csv-01.csv` и привести в вид
    “аккуратных данных”.
2.  Провести анализ точек доступа.
3.  Провести анализ данных клиентов.
4.  Ответить на поставленные вопросы.

## Ход выполнения работы

### Этап 1. Подготовка данных

Для начала установим пакет `dplyr`.

``` r
library(dplyr)
```

    Warning: пакет 'dplyr' был собран под R версии 4.2.3


    Присоединяю пакет: 'dplyr'

    Следующие объекты скрыты от 'package:stats':

        filter, lag

    Следующие объекты скрыты от 'package:base':

        intersect, setdiff, setequal, union

Импортируем данные из общего файла файла в 2 разных датафрейма: анонсы
беспроводных точек доступа и запросы на подключение клиентов к известным
им точкам доступа. При выводе всего датафрейма заметим, что в первом
датафрейме всего 167 строк.

``` r
ds1 <- read.csv("mir.csv-01.csv", nrows = 167)
ds1 %>% head(10)
```

                   BSSID      First.time.seen       Last.time.seen channel Speed
    1  BE:F1:71:D5:17:8B  2023-07-28 09:13:03  2023-07-28 11:50:50       1   195
    2  6E:C7:EC:16:DA:1A  2023-07-28 09:13:03  2023-07-28 11:55:12       1   130
    3  9A:75:A8:B9:04:1E  2023-07-28 09:13:03  2023-07-28 11:53:31       1   360
    4  4A:EC:1E:DB:BF:95  2023-07-28 09:13:03  2023-07-28 11:04:01       7   360
    5  D2:6D:52:61:51:5D  2023-07-28 09:13:03  2023-07-28 10:30:19       6   130
    6  E8:28:C1:DC:B2:52  2023-07-28 09:13:03  2023-07-28 11:55:38       6   130
    7  BE:F1:71:D6:10:D7  2023-07-28 09:13:03  2023-07-28 11:50:44      11   195
    8  0A:C5:E1:DB:17:7B  2023-07-28 09:13:03  2023-07-28 11:36:31      11   130
    9  38:1A:52:0D:84:D7  2023-07-28 09:13:03  2023-07-28 10:25:02      11   130
    10 BE:F1:71:D5:0E:53  2023-07-28 09:13:03  2023-07-28 10:29:21       1   195
       Privacy Cipher Authentication Power X..beacons X..IV           LAN.IP
    1     WPA2   CCMP            PSK   -30        846   504    0.  0.  0.  0
    2     WPA2   CCMP            PSK   -30        750   116    0.  0.  0.  0
    3     WPA2   CCMP            PSK   -68        694    26    0.  0.  0.  0
    4     WPA2   CCMP            PSK   -37        510    21    0.  0.  0.  0
    5     WPA2   CCMP            PSK   -57        647     6    0.  0.  0.  0
    6      OPN                         -63        251  3430  172. 17.203.197
    7     WPA2   CCMP            PSK   -27       1647    80    0.  0.  0.  0
    8     WPA2   CCMP            PSK   -38       1251    11    0.  0.  0.  0
    9     WPA2   CCMP            PSK   -38        704     0    0.  0.  0.  0
    10    WPA2   CCMP            PSK   -66        617     0    0.  0.  0.  0
       ID.length                     ESSID Key
    1         12              C322U13 3965  NA
    2          4                      Cnet  NA
    3          2                        KC  NA
    4         14            POCO X5 Pro 5G  NA
    5         25                            NA
    6         13             MIREA_HOTSPOT  NA
    7         12              C322U21 0566  NA
    8         13             AndroidAP177B  NA
    9         24  EBFCD57F-EE81fI_DL_1AO2T  NA
    10        12              C322U06 9080  NA

Следующим импортируем второй датафрейм - запросы на подключение клиентов
к известным им точкам доступа. Заметим, что нужно пропустить несколько
строк, которые относятся к предыдущему датафрейму. При задавании номера
строки skip нужно смотреть на положение датафрейма. Нужная строка =\>
169.

``` r
ds2 <- read.csv("mir.csv-01.csv", skip = 169)
ds2 %>% head(10)
```

             Station.MAC      First.time.seen       Last.time.seen Power X..packets
    1  CA:66:3B:8F:56:DD  2023-07-28 09:13:03  2023-07-28 10:59:44   -33        858
    2  96:35:2D:3D:85:E6  2023-07-28 09:13:03  2023-07-28 09:13:03   -65          4
    3  5C:3A:45:9E:1A:7B  2023-07-28 09:13:03  2023-07-28 11:51:54   -39        432
    4  C0:E4:34:D8:E7:E5  2023-07-28 09:13:03  2023-07-28 11:53:16   -61        958
    5  5E:8E:A6:5E:34:81  2023-07-28 09:13:04  2023-07-28 09:13:04   -53          1
    6  10:51:07:CB:33:E7  2023-07-28 09:13:05  2023-07-28 11:56:06   -43        344
    7  68:54:5A:40:35:9E  2023-07-28 09:13:06  2023-07-28 11:50:50   -31        163
    8         Galaxy A71                                                           
    9  74:4C:A1:70:CE:F7  2023-07-28 09:13:06  2023-07-28 09:20:01   -71          3
    10 8A:A3:5A:33:76:57  2023-07-28 09:13:06  2023-07-28 10:20:27   -74        115
                    BSSID Probed.ESSIDs
    1   BE:F1:71:D5:17:8B  C322U13 3965
    2   (not associated)   IT2 Wireless
    3   BE:F1:71:D6:10:D7  C322U21 0566
    4   BE:F1:71:D5:17:8B  C322U13 3965
    5   (not associated)               
    6   (not associated)               
    7   1E:93:E3:1B:3C:F4  C322U06 5179
    8                                  
    9   E8:28:C1:DC:FF:F2              
    10  00:25:00:FF:94:73              

Приведём в вид “аккуратных данных” первый датафрейм - анонсы
беспроводных точек доступа.

Посмотрим на первоначальный вид первого датафрейма.

``` r
ds1 %>% glimpse() 
```

    Rows: 167
    Columns: 15
    $ BSSID           <chr> "BE:F1:71:D5:17:8B", "6E:C7:EC:16:DA:1A", "9A:75:A8:B9…
    $ First.time.seen <chr> " 2023-07-28 09:13:03", " 2023-07-28 09:13:03", " 2023…
    $ Last.time.seen  <chr> " 2023-07-28 11:50:50", " 2023-07-28 11:55:12", " 2023…
    $ channel         <int> 1, 1, 1, 7, 6, 6, 11, 11, 11, 1, 6, 14, 11, 11, 6, 6, …
    $ Speed           <int> 195, 130, 360, 360, 130, 130, 195, 130, 130, 195, 180,…
    $ Privacy         <chr> " WPA2", " WPA2", " WPA2", " WPA2", " WPA2", " OPN", "…
    $ Cipher          <chr> " CCMP", " CCMP", " CCMP", " CCMP", " CCMP", " ", " CC…
    $ Authentication  <chr> " PSK", " PSK", " PSK", " PSK", " PSK", "   ", " PSK",…
    $ Power           <int> -30, -30, -68, -37, -57, -63, -27, -38, -38, -66, -42,…
    $ X..beacons      <int> 846, 750, 694, 510, 647, 251, 1647, 1251, 704, 617, 13…
    $ X..IV           <int> 504, 116, 26, 21, 6, 3430, 80, 11, 0, 0, 86, 0, 0, 0, …
    $ LAN.IP          <chr> "   0.  0.  0.  0", "   0.  0.  0.  0", "   0.  0.  0.…
    $ ID.length       <int> 12, 4, 2, 14, 25, 13, 12, 13, 24, 12, 10, 0, 24, 24, 1…
    $ ESSID           <chr> " C322U13 3965", " Cnet", " KC", " POCO X5 Pro 5G", " …
    $ Key             <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…

Преобразуем тип данных `chr` в `dttm` для столбцов `First.time.seen` и
`First.time.seen`. Это нужно для корректного отображения даты и времени.
Затем посмотрим на изменённый датафрейм.

``` r
ds1$First.time.seen <- as.POSIXct(ds1$First.time.seen, 
                                  format = "%Y-%m-%d %H:%M:%S")
ds1$Last.time.seen <- as.POSIXct(ds1$Last.time.seen, 
                                 format = "%Y-%m-%d %H:%M:%S")
ds1 %>% glimpse() 
```

    Rows: 167
    Columns: 15
    $ BSSID           <chr> "BE:F1:71:D5:17:8B", "6E:C7:EC:16:DA:1A", "9A:75:A8:B9…
    $ First.time.seen <dttm> 2023-07-28 09:13:03, 2023-07-28 09:13:03, 2023-07-28 …
    $ Last.time.seen  <dttm> 2023-07-28 11:50:50, 2023-07-28 11:55:12, 2023-07-28 …
    $ channel         <int> 1, 1, 1, 7, 6, 6, 11, 11, 11, 1, 6, 14, 11, 11, 6, 6, …
    $ Speed           <int> 195, 130, 360, 360, 130, 130, 195, 130, 130, 195, 180,…
    $ Privacy         <chr> " WPA2", " WPA2", " WPA2", " WPA2", " WPA2", " OPN", "…
    $ Cipher          <chr> " CCMP", " CCMP", " CCMP", " CCMP", " CCMP", " ", " CC…
    $ Authentication  <chr> " PSK", " PSK", " PSK", " PSK", " PSK", "   ", " PSK",…
    $ Power           <int> -30, -30, -68, -37, -57, -63, -27, -38, -38, -66, -42,…
    $ X..beacons      <int> 846, 750, 694, 510, 647, 251, 1647, 1251, 704, 617, 13…
    $ X..IV           <int> 504, 116, 26, 21, 6, 3430, 80, 11, 0, 0, 86, 0, 0, 0, …
    $ LAN.IP          <chr> "   0.  0.  0.  0", "   0.  0.  0.  0", "   0.  0.  0.…
    $ ID.length       <int> 12, 4, 2, 14, 25, 13, 12, 13, 24, 12, 10, 0, 24, 24, 1…
    $ ESSID           <chr> " C322U13 3965", " Cnet", " KC", " POCO X5 Pro 5G", " …
    $ Key             <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…

Далее приведём в вид “аккуратных данных” второй датафрейм - запросы на
подключение клиентов к известным им точкам доступа.

Посмотрим на первоначальный вид второго датафрейм.

``` r
ds2 %>% glimpse() 
```

    Rows: 12,269
    Columns: 7
    $ Station.MAC     <chr> "CA:66:3B:8F:56:DD", "96:35:2D:3D:85:E6", "5C:3A:45:9E…
    $ First.time.seen <chr> " 2023-07-28 09:13:03", " 2023-07-28 09:13:03", " 2023…
    $ Last.time.seen  <chr> " 2023-07-28 10:59:44", " 2023-07-28 09:13:03", " 2023…
    $ Power           <chr> " -33", " -65", " -39", " -61", " -53", " -43", " -31"…
    $ X..packets      <chr> "      858", "        4", "      432", "      958", " …
    $ BSSID           <chr> " BE:F1:71:D5:17:8B", " (not associated) ", " BE:F1:71…
    $ Probed.ESSIDs   <chr> "C322U13 3965", "IT2 Wireless", "C322U21 0566", "C322U…

Преобразуем тип данных `chr` в `dttm` для столбцов `First.time.seen` и
`First.time.seen`. Это нужно для корректного отображения даты и времени.
Затем посмотрим на изменённый датафрейм.

``` r
ds2$First.time.seen <- as.POSIXct(ds2$First.time.seen, 
                                  format = "%Y-%m-%d %H:%M:%S")
ds2$Last.time.seen <- as.POSIXct(ds2$Last.time.seen, 
                                 format = "%Y-%m-%d %H:%M:%S")
ds2 %>% glimpse() 
```

    Rows: 12,269
    Columns: 7
    $ Station.MAC     <chr> "CA:66:3B:8F:56:DD", "96:35:2D:3D:85:E6", "5C:3A:45:9E…
    $ First.time.seen <dttm> 2023-07-28 09:13:03, 2023-07-28 09:13:03, 2023-07-28 …
    $ Last.time.seen  <dttm> 2023-07-28 10:59:44, 2023-07-28 09:13:03, 2023-07-28 …
    $ Power           <chr> " -33", " -65", " -39", " -61", " -53", " -43", " -31"…
    $ X..packets      <chr> "      858", "        4", "      432", "      958", " …
    $ BSSID           <chr> " BE:F1:71:D5:17:8B", " (not associated) ", " BE:F1:71…
    $ Probed.ESSIDs   <chr> "C322U13 3965", "IT2 Wireless", "C322U21 0566", "C322U…

Заметим, что в некоторых данных есть лишние пробелы, которые нужно
убрать, для читабельности датафреймов.

``` r
ds1 <- mutate_all(ds1, trimws) 
ds1 %>% glimpse() 
```

    Rows: 167
    Columns: 15
    $ BSSID           <chr> "BE:F1:71:D5:17:8B", "6E:C7:EC:16:DA:1A", "9A:75:A8:B9…
    $ First.time.seen <chr> "2023-07-28 09:13:03", "2023-07-28 09:13:03", "2023-07…
    $ Last.time.seen  <chr> "2023-07-28 11:50:50", "2023-07-28 11:55:12", "2023-07…
    $ channel         <chr> "1", "1", "1", "7", "6", "6", "11", "11", "11", "1", "…
    $ Speed           <chr> "195", "130", "360", "360", "130", "130", "195", "130"…
    $ Privacy         <chr> "WPA2", "WPA2", "WPA2", "WPA2", "WPA2", "OPN", "WPA2",…
    $ Cipher          <chr> "CCMP", "CCMP", "CCMP", "CCMP", "CCMP", "", "CCMP", "C…
    $ Authentication  <chr> "PSK", "PSK", "PSK", "PSK", "PSK", "", "PSK", "PSK", "…
    $ Power           <chr> "-30", "-30", "-68", "-37", "-57", "-63", "-27", "-38"…
    $ X..beacons      <chr> "846", "750", "694", "510", "647", "251", "1647", "125…
    $ X..IV           <chr> "504", "116", "26", "21", "6", "3430", "80", "11", "0"…
    $ LAN.IP          <chr> "0.  0.  0.  0", "0.  0.  0.  0", "0.  0.  0.  0", "0.…
    $ ID.length       <chr> "12", "4", "2", "14", "25", "13", "12", "13", "24", "1…
    $ ESSID           <chr> "C322U13 3965", "Cnet", "KC", "POCO X5 Pro 5G", "", "M…
    $ Key             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…

``` r
ds2 <- mutate_all(ds2, trimws) 
ds2 %>% glimpse() 
```

    Rows: 12,269
    Columns: 7
    $ Station.MAC     <chr> "CA:66:3B:8F:56:DD", "96:35:2D:3D:85:E6", "5C:3A:45:9E…
    $ First.time.seen <chr> "2023-07-28 09:13:03", "2023-07-28 09:13:03", "2023-07…
    $ Last.time.seen  <chr> "2023-07-28 10:59:44", "2023-07-28 09:13:03", "2023-07…
    $ Power           <chr> "-33", "-65", "-39", "-61", "-53", "-43", "-31", "", "…
    $ X..packets      <chr> "858", "4", "432", "958", "1", "344", "163", "", "3", …
    $ BSSID           <chr> "BE:F1:71:D5:17:8B", "(not associated)", "BE:F1:71:D6:…
    $ Probed.ESSIDs   <chr> "C322U13 3965", "IT2 Wireless", "C322U21 0566", "C322U…

### Этап 2. Анализ

#### Точки доступа

1.  Определим небезопасные точки доступа (без шифрования – OPN).

``` r
open_df <- ds1 %>% filter(Privacy == "OPN") %>%
  select(BSSID, Privacy, LAN.IP, ESSID)

open_df
```

                   BSSID Privacy          LAN.IP         ESSID
    1  E8:28:C1:DC:B2:52     OPN 172. 17.203.197 MIREA_HOTSPOT
    2  E8:28:C1:DC:B2:50     OPN 172. 17. 95.169  MIREA_GUESTS
    3  E8:28:C1:DC:B2:51     OPN   0.  0.  0.  0              
    4  E8:28:C1:DC:FF:F2     OPN 172. 17. 84.217              
    5  00:25:00:FF:94:73     OPN   0.  0.  0.  0              
    6  E8:28:C1:DD:04:52     OPN 172. 17.216.149 MIREA_HOTSPOT
    7  E8:28:C1:DE:74:31     OPN   0.  0.  0.  0              
    8  E8:28:C1:DE:74:32     OPN 172. 17. 93.250 MIREA_HOTSPOT
    9  E8:28:C1:DC:C8:32     OPN 192.168.155. 53 MIREA_HOTSPOT
    10 E8:28:C1:DD:04:50     OPN 192.168.  0.  1  MIREA_GUESTS
    11 E8:28:C1:DD:04:51     OPN   0.  0.  0.  0              
    12 E8:28:C1:DC:C8:30     OPN 172. 17.105.120  MIREA_GUESTS
    13 E8:28:C1:DE:74:30     OPN   0.  0.  0.  0              
    14 E0:D9:E3:48:FF:D2     OPN 192.168. 14.235              
    15 E8:28:C1:DC:B2:41     OPN 169.254.175.203  MIREA_GUESTS
    16 E8:28:C1:DC:B2:40     OPN 172. 17.203.197 MIREA_HOTSPOT
    17 00:26:99:F2:7A:E0     OPN   0.  0.  0.  0              
    18 E8:28:C1:DC:B2:42     OPN   0.  0.  0.  0              
    19 E8:28:C1:DD:04:40     OPN 172. 17. 84.175 MIREA_HOTSPOT
    20 E8:28:C1:DD:04:41     OPN 172. 17. 84.175  MIREA_GUESTS
    21 E8:28:C1:DE:47:D2     OPN   0.  0.  0.  0 MIREA_HOTSPOT
    22 02:BC:15:7E:D5:DC     OPN   0.  0.  0.  0       MT_FREE
    23 E8:28:C1:DC:C6:B1     OPN   0.  0.  0.  0              
    24 E8:28:C1:DD:04:42     OPN   0.  0.  0.  0              
    25 E8:28:C1:DC:C8:31     OPN   0.  0.  0.  0              
    26 E8:28:C1:DE:47:D1     OPN   0.  0.  0.  0              
    27 00:AB:0A:00:10:10     OPN   0.  0.  0.  0              
    28 E8:28:C1:DC:C6:B0     OPN   0.  0.  0.  0  MIREA_GUESTS
    29 E8:28:C1:DC:C6:B2     OPN 192.168.  0.  1              
    30 E8:28:C1:DC:BD:50     OPN   0.  0.  0.  0  MIREA_GUESTS
    31 E8:28:C1:DC:0B:B2     OPN   0.  0.  0.  0              
    32 E8:28:C1:DC:33:12     OPN   0.  0.  0.  0              
    33 00:03:7A:1A:03:56     OPN   0.  0.  0.  0       MT_FREE
    34 00:03:7F:12:34:56     OPN   0.  0.  0.  0       MT_FREE
    35 00:3E:1A:5D:14:45     OPN   0.  0.  0.  0       MT_FREE
    36 E0:D9:E3:49:00:B1     OPN   0.  0.  0.  0              
    37 E8:28:C1:DC:BD:52     OPN   0.  0.  0.  0 MIREA_HOTSPOT
    38 00:26:99:F2:7A:EF     OPN   0.  0.  0.  0              
    39 02:67:F1:B0:6C:98     OPN   0.  0.  0.  0       MT_FREE
    40 02:CF:8B:87:B4:F9     OPN   0.  0.  0.  0       MT_FREE
    41 00:53:7A:99:98:56     OPN   0.  0.  0.  0       MT_FREE
    42 E8:28:C1:DE:47:D0     OPN   0.  0.  0.  0  MIREA_GUESTS

1.  Определим производителя для каждого обнаруженного устройства. Для
    начала найдём уникальные устройства из списка обнаруженных.

``` r
mac_id <- sub("^([A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}).*", "\\1", open_df$BSSID) %>% unique()

mac_id
```

     [1] "E8:28:C1" "00:25:00" "E0:D9:E3" "00:26:99" "02:BC:15" "00:AB:0A"
     [7] "00:03:7A" "00:03:7F" "00:3E:1A" "02:67:F1" "02:CF:8B" "00:53:7A"

С помощью сервиса https://www.wireshark.org/tools/oui-lookup.html
определим производителя для каждого обнаруженного устройства. Некоторые
устройства не находятся с помощью данного сервиса, поэтому приведём
список тех, которые смогли найти:

-   00:03:7A Taiyo Yuden Co., Ltd.
-   00:03:7F Atheros Communications, Inc.
-   00:25:00 Apple, Inc.
-   00:26:99 Cisco Systems, Inc
-   E0:D9:E3 Eltex Enterprise Ltd.
-   E8:28:C1 Eltex Enterprise Ltd.

#### Данные клиентов

## Оценка результатов

ааа

## Вывод

ааа
